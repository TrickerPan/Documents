# 1.1. 遇到的问题

Laravel 框架的基础是一个功能强大的控制反转容器（IoC container）。 为了真正理解本框架，需要好好掌握该容器。但我们要搞清楚，控制反转容器只是一种用于方便实现“依赖注入”的工具。要实现依赖注入并不一定需要控制反转容器，只是用容器会更方便和容易一点儿。

首先来看看我们为何要使用依赖注入，它能带来什么好处。 考虑下列代码：

```php
class UserController extends BaseController{
    public function getIndex()
    {
        $users= User::all();
        return View::make('users.index', compact('users'));
    }
}
```

这段代码很简短，但我们要想测试这段代码的话就一定会和实际的数据库发生联系。也就是说， Eloquent ORM 和该控制器有着紧耦合。如果不使用 Eloquent ORM，不连接到实际数据库，我们就没办法运行或者测试这段代码。这段代码同时也违背了“关注分离”这个软件设计原则。简单讲：这个控制器知道的太多了。 控制器不需要去了解数据是从哪儿来的，只要知道如何访问就行。控制器也不需要知道这数据是从 MySQL 或哪儿来的，只需要知道这数据目前是可用的。

> **关注分离**
>
> 每一个类都应该有单独的职责，并且该职责应完全被这个类封装。

关注分离的好处就是能让 Web 控制器和数据访问解耦。这会使得实现存储迁移更容易，测试也会更容易。“Web” 就仅仅是为你真正的应用做数据的传输了。

想象一下你有一个类似于监视器的程序，有着很多线缆接口（HDMI，VGA，DVI等等）。 你可以通过不同的接口访问不同的监视器。把 Internet 想象成另一个插进你程序线缆接口。大部分显示器的功能是与线缆接口互相独立的。线缆接口只是一 种传输机制就像 HTTP 是你程序的一种传输机制一样。所以我们不想把传输机制（控制器）和业务逻辑混在一起。这样的好处是很多其他的传输机制比如 API 调用、移动应用等都可以访问我们的业务逻辑。

那么我们就别再将控制器和 Eloquent ORM 耦合在一起了。 咱们注入一个资料库类。

[原文](../1.%20Dependency%20Injection/1.1.%20The%20Problem.md)  
[下一节](1.%20依赖注入/1.1.%20遇到的问题.md)  
[目录](../目录.md)
